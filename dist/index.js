/*!
 * @rybbit/node v1.0.0
 * Rybbit Node.js SDK
 * (c) 2026 Rybbit
 * Released under the AGPL-3.0-only license.
 */
"use strict";var a=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var h=Object.getOwnPropertyNames;var v=Object.prototype.hasOwnProperty;var P=(e,t)=>{for(var r in t)a(e,r,{get:t[r],enumerable:!0})},w=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of h(t))!v.call(e,i)&&i!==r&&a(e,i,{get:()=>t[i],enumerable:!(n=u(t,i))||n.enumerable});return e};var R=e=>w(a({},"__esModule",{value:!0}),e);var k={};P(k,{Rybbit:()=>g});module.exports=R(k);function f(e){if(typeof e!="object"||e===null)throw new Error("Invalid configuration. Expected an object.");if(!e.analyticsHost||e.analyticsHost.trim()==="")throw new Error("`analyticsHost` is required in Rybbit config and must be a non-empty string.");let t=e.analyticsHost.replace(/\/$/,"");if(!e.siteId||String(e.siteId).trim()==="")throw new Error("`siteId` is required in Rybbit config and must be a non-empty string or number.");let r=String(e.siteId);if(!e.apiKey||e.apiKey.trim()==="")throw new Error("`apiKey` is required in Rybbit config and must be a non-empty string.");return{analyticsHost:t,siteId:r,apiKey:e.apiKey,debug:e.debug}}async function s(e,t,r,n={},i={}){let{eventName:c,properties:y={}}=i;if(e==="custom_event"&&!c)throw new Error("Event name is required and must be a string for custom events.");let d={site_id:t.siteId,type:e,...n,...e==="custom_event"&&{event_name:c},...e==="custom_event"&&Object.keys(y).length>0&&{properties:JSON.stringify(y)}},l=`${t.analyticsHost}/track`,m=JSON.stringify(d),p=new Headers({"Content-Type":"application/json",Authorization:`Bearer ${t.apiKey}`});r.log("Sending track event to:",l),r.log("Payload:",d);try{let o=await fetch(l,{method:"POST",headers:p,body:m});o.ok?r.log(await o.text()):r.error(`Error sending event: ${o.status} ${o.statusText}`,await o.text().catch(()=>""))}catch(o){r.error("Failed to send event:",o)}}function b(e){return{log:(...t)=>{e&&console.log("[Rybbit]",...t)},error:(...t)=>{e&&console.error("[Rybbit Error]",...t)}}}var g=class{constructor(t){this.config=f(t),this.logger=b(this.config.debug??!1),this.logger.log("Rybbit Node.js SDK Initialized."),this.logger.log("Config:",this.config)}async pageview(t){try{await s("pageview",this.config,this.logger,t)}catch(r){this.logger.error("Tracking request failed at the pageview method level.",r)}}async event(t,r,n){try{await s("custom_event",this.config,this.logger,r,{eventName:t,properties:n})}catch(i){this.logger.error("Tracking request failed at the event method level.",i)}}};0&&(module.exports={Rybbit});
