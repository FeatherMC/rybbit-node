/*!
 * @rybbit/node v1.0.0
 * Rybbit Node.js SDK
 * (c) 2026 Rybbit
 * Released under the AGPL-3.0-only license.
 */
function d(e){if(typeof e!="object"||e===null)throw new Error("Invalid configuration. Expected an object.");if(!e.analyticsHost||e.analyticsHost.trim()==="")throw new Error("`analyticsHost` is required in Rybbit config and must be a non-empty string.");let t=e.analyticsHost.replace(/\/$/,"");if(!e.siteId||String(e.siteId).trim()==="")throw new Error("`siteId` is required in Rybbit config and must be a non-empty string or number.");let r=String(e.siteId);if(!e.apiKey||e.apiKey.trim()==="")throw new Error("`apiKey` is required in Rybbit config and must be a non-empty string.");return{analyticsHost:t,siteId:r,apiKey:e.apiKey,debug:e.debug}}async function a(e,t,r,o={},n={}){let{eventName:s,properties:g={}}=n;if(e==="custom_event"&&!s)throw new Error("Event name is required and must be a string for custom events.");let c={site_id:t.siteId,type:e,...o,...e==="custom_event"&&{event_name:s},...e==="custom_event"&&Object.keys(g).length>0&&{properties:JSON.stringify(g)}},y=`${t.analyticsHost}/track`,b=JSON.stringify(c),m=new Headers({"Content-Type":"application/json",Authorization:`Bearer ${t.apiKey}`});r.log("Sending track event to:",y),r.log("Payload:",c);try{let i=await fetch(y,{method:"POST",headers:m,body:b});i.ok?r.log(await i.text()):r.error(`Error sending event: ${i.status} ${i.statusText}`,await i.text().catch(()=>""))}catch(i){r.error("Failed to send event:",i)}}function l(e){return{log:(...t)=>{e&&console.log("[Rybbit]",...t)},error:(...t)=>{e&&console.error("[Rybbit Error]",...t)}}}var f=class{constructor(t){this.config=d(t),this.logger=l(this.config.debug??!1),this.logger.log("Rybbit Node.js SDK Initialized."),this.logger.log("Config:",this.config)}async pageview(t){try{await a("pageview",this.config,this.logger,t)}catch(r){this.logger.error("Tracking request failed at the pageview method level.",r)}}async event(t,r,o){try{await a("custom_event",this.config,this.logger,r,{eventName:t,properties:o})}catch(n){this.logger.error("Tracking request failed at the event method level.",n)}}};export{f as Rybbit};
